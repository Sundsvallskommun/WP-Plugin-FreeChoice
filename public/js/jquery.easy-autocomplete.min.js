var EasyAutocomplete=function(a){return a.Configuration=function(b){function e(){if("xml"===b.dataType&&(b.getValue||(b.getValue=function(a){return $(a).text()}),b.list||(b.list={}),b.list.sort||(b.list.sort={}),b.list.sort.method=function(a,c){return a=b.getValue(a),c=b.getValue(c),a<c?-1:a>c?1:0},b.list.match||(b.list.match={}),b.list.match.method=function(a,b){return a.search(b)>-1}),void 0!==b.categories&&b.categories instanceof Array){for(var a=[],d=0,e=b.categories.length;d<e;d+=1){var f=b.categories[d];for(var g in c.categories[0])void 0===f[g]&&(f[g]=c.categories[0][g]);a.push(f)}b.categories=a}}function f(){function a(b,c){var d=b||{};for(var e in b)void 0!==c[e]&&null!==c[e]&&("object"!=typeof c[e]||c[e]instanceof Array?d[e]=c[e]:a(b[e],c[e]));return void 0!==c.data&&null!==c.data&&"object"==typeof c.data&&(d.data=c.data),d}c=a(c,b)}function g(){if("list-required"!==c.url&&"function"!=typeof c.url){var a=c.url;c.url=function(){return a}}if(void 0!==c.ajaxSettings.url&&"function"!=typeof c.ajaxSettings.url){var a=c.ajaxSettings.url;c.ajaxSettings.url=function(){return a}}if("string"==typeof c.listLocation){var d=c.listLocation;"XML"===c.dataType.toUpperCase()?c.listLocation=function(a){return $(a).find(d)}:c.listLocation=function(a){return a[d]}}if("string"==typeof c.getValue){var e=c.getValue;c.getValue=function(a){return a[e]}}void 0!==b.categories&&(c.categoriesAssigned=!0)}function h(){void 0!==b.ajaxSettings&&"object"==typeof b.ajaxSettings?c.ajaxSettings=b.ajaxSettings:c.ajaxSettings={}}function i(a){return void 0!==c[a]&&null!==c[a]}function j(a,b){function e(b,c){for(var f in c)void 0===b[f]&&a.log("Property '"+f+"' does not exist in EasyAutocomplete options API."),"object"==typeof b[f]&&$.inArray(f,d)===-1&&e(b[f],c[f])}e(c,b)}var c={data:"list-required",url:"list-required",dataType:"json",listLocation:function(a){return a},xmlElementName:"",getValue:function(a){return a},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},matchResponseProperty:!1,list:{sort:{enabled:!1,method:function(a,b){return a=c.getValue(a),b=c.getValue(b),a<b?-1:a>b?1:0}},maxNumberOfElements:6,hideOnEmptyPhrase:!0,match:{enabled:!1,caseSensitive:!1,method:function(a,b){return!!a.startsWith(b)}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:!0,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:!0,ajaxSettings:{},preparePostData:function(a,b){return a},loggerEnabled:!0,template:"",categoriesAssigned:!1,categories:[{maxNumberOfElements:4}]},d=["ajaxSettings","template"];this.get=function(a){return c[a]},this.equals=function(a,b){return!(!i(a)||c[a]!==b)},this.checkDataUrlProperties=function(){return"list-required"!==c.url||"list-required"!==c.data},this.checkRequiredProperties=function(){for(var a in c)if("required"===c[a])return logger.error("Option "+a+" must be defined"),!1;return!0},this.printPropertiesThatDoesntExist=function(a,b){j(a,b)},e(),f(),c.loggerEnabled===!0&&j(console,b),h(),g()},a}(EasyAutocomplete||{}),EasyAutocomplete=function(a){return a.Logger=function(){this.error=function(a){console.log("ERROR: "+a)},this.warning=function(a){console.log("WARNING: "+a)}},a}(EasyAutocomplete||{}),EasyAutocomplete=function(a){return a.Constans=function(){var b={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(a){return b[a]}},a}(EasyAutocomplete||{}),EasyAutocomplete=function(a){return a.ListBuilderService=function(b,c){function d(a,c){function f(){var e,d={};return void 0!==a.xmlElementName&&(d.xmlElementName=a.xmlElementName),void 0!==a.listLocation?e=a.listLocation:void 0!==b.get("listLocation")&&(e=b.get("listLocation")),void 0!==e?"string"==typeof e?d.data=$(c).find(e):"function"==typeof e&&(d.data=e(c)):d.data=c,d}function g(){var b={};return void 0!==a.listLocation?"string"==typeof a.listLocation?b.data=c[a.listLocation]:"function"==typeof a.listLocation&&(b.data=a.listLocation(c)):b.data=c,b}var d={};if(d="XML"===b.get("dataType").toUpperCase()?f():g(),void 0!==a.header&&(d.header=a.header),void 0!==a.maxNumberOfElements&&(d.maxNumberOfElements=a.maxNumberOfElements),void 0!==b.get("list").maxNumberOfElements&&(d.maxListSize=b.get("list").maxNumberOfElements),void 0!==a.getValue)if("string"==typeof a.getValue){var e=a.getValue;d.getValue=function(a){return a[e]}}else"function"==typeof a.getValue&&(d.getValue=a.getValue);else d.getValue=b.get("getValue");return d}function e(a){var c=[];return void 0===a.xmlElementName&&(a.xmlElementName=b.get("xmlElementName")),$(a.data).find(a.xmlElementName).each(function(){c.push(this)}),c}this.init=function(a){var c=[],d={};return d.data=b.get("listLocation")(a),d.getValue=b.get("getValue"),d.maxListSize=b.get("list").maxNumberOfElements,c.push(d),c},this.updateCategories=function(a,c){if(b.get("categoriesAssigned")){a=[];for(var e=0;e<b.get("categories").length;e+=1){var f=d(b.get("categories")[e],c);a.push(f)}}return a},this.convertXml=function(a){if("XML"===b.get("dataType").toUpperCase())for(var c=0;c<a.length;c+=1)a[c].data=e(a[c]);return a},this.processData=function(a,d){for(var e=0,f=a.length;e<f;e+=1)a[e].data=c(b,a[e],d);return a},this.checkIfDataExists=function(a){for(var b=0,c=a.length;b<c;b+=1)if(void 0!==a[b].data&&a[b].data instanceof Array&&a[b].data.length>0)return!0;return!1}},a}(EasyAutocomplete||{}),EasyAutocomplete=function(a){return a.proccess=function(c,d,e){function h(a,b){var d=[],e="";if(c.get("list").match.enabled)for(var f=0,g=a.length;f<g;f+=1)e=c.get("getValue")(a[f]),i(e,b)&&d.push(a[f]);else d=a;return d}function i(a,b){return c.get("list").match.caseSensitive||("string"==typeof a&&(a=a.toLowerCase()),b=b.toLowerCase()),!!c.get("list").match.method(a,b)}function j(a){return void 0!==d.maxNumberOfElements&&a.length>d.maxNumberOfElements&&(a=a.slice(0,d.maxNumberOfElements)),a}function k(a){return c.get("list").sort.enabled&&a.sort(c.get("list").sort.method),a}a.proccess.match=i;var f=d.data,g=e;return f=h(f,g),f=j(f),f=k(f)},a}(EasyAutocomplete||{}),EasyAutocomplete=function(a){return a.Template=function(b){var c={basic:{type:"basic",method:function(a){return a},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(a){return a+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(a){return a},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(a){return a},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(a){return a},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}},d=function(a){var d,b=a.fields;return"description"===a.type?(d=c.description.method,"string"==typeof b.description?d=function(a,c){return a+" - <span>"+c[b.description]+"</span>"}:"function"==typeof b.description&&(d=function(a,c){return a+" - <span>"+b.description(c)+"</span>"}),d):"iconRight"===a.type?("string"==typeof b.iconSrc?d=function(a,c){return a+"<img class='eac-icon' src='"+c[b.iconSrc]+"' />"}:"function"==typeof b.iconSrc&&(d=function(a,c){return a+"<img class='eac-icon' src='"+b.iconSrc(c)+"' />"}),d):"iconLeft"===a.type?("string"==typeof b.iconSrc?d=function(a,c){return"<img class='eac-icon' src='"+c[b.iconSrc]+"' />"+a}:"function"==typeof b.iconSrc&&(d=function(a,c){return"<img class='eac-icon' src='"+b.iconSrc(c)+"' />"+a}),d):"links"===a.type?("string"==typeof b.link?d=function(a,c){return"<a href='"+c[b.link]+"' >"+a+"</a>"}:"function"==typeof b.link&&(d=function(a,c){return"<a href='"+b.link(c)+"' >"+a+"</a>"}),d):"custom"===a.type?a.method:c.basic.method},e=function(a){return a&&a.type&&a.type&&c[a.type]?d(a):c.basic.method},f=function(a){var b=function(){return""};return a&&a.type&&a.type&&c[a.type]?function(){var b=c[a.type].cssClass;return function(){return b}}():b};this.getTemplateClass=f(b),this.build=e(b)},a}(EasyAutocomplete||{}),EasyAutocomplete=function(a){return a.main=function(c,d){function q(){return 0===l.length?void h.error("Input field doesn't exist."):g.checkDataUrlProperties()?g.checkRequiredProperties()?(r(),void t()):void h.error("Will not work without mentioned properties."):void h.error("One of options variables 'data' or 'url' must be defined.")}function r(){function a(){var a=$("<div>"),c=f.getValue("WRAPPER_CSS_CLASS");g.get("theme")&&""!==g.get("theme")&&(c+=" eac-"+g.get("theme")),g.get("cssClasses")&&""!==g.get("cssClasses")&&(c+=" "+g.get("cssClasses")),""!==i.getTemplateClass()&&(c+=" "+i.getTemplateClass()),a.addClass(c),l.wrap(a),g.get("adjustWidth")===!0&&b()}function b(){var a=l.outerWidth();l.parent().css("width",a)}function c(){l.unwrap()}function d(){var a=$("<div>").addClass(f.getValue("CONTAINER_CLASS"));a.attr("id",s()).prepend($('<ul class="sk-free-choice-list-group">')),function(){a.on("show.eac",function(){switch(g.get("list").showAnimation.type){case"slide":var b=g.get("list").showAnimation.time,c=g.get("list").showAnimation.callback;a.find("ul").slideDown(b,c);break;case"fade":var b=g.get("list").showAnimation.time,c=g.get("list").showAnimation.callback;a.find("ul").fadeIn(b),c;break;default:a.find("ul").show()}g.get("list").onShowListEvent()}).on("hide.eac",function(){switch(g.get("list").hideAnimation.type){case"slide":var b=g.get("list").hideAnimation.time,c=g.get("list").hideAnimation.callback;a.find("ul").slideUp(b,c);break;case"fade":var b=g.get("list").hideAnimation.time,c=g.get("list").hideAnimation.callback;a.find("ul").fadeOut(b,c);break;default:a.find("ul").hide()}g.get("list").onHideListEvent()}).on("selectElement.eac",function(){a.find("ul li").removeClass("selected"),a.find("ul li").eq(o).addClass("selected"),g.get("list").onSelectItemEvent()}).on("loadElements.eac",function(b,c,d){var e="",f=a.find("ul");f.empty().detach(),n=[];for(var j=0,k=0,m=c.length;k<m;k+=1){var p=c[k].data;if(0!==p.length){void 0!==c[k].header&&c[k].header.length>0&&f.append("<div class='eac-category' >"+c[k].header+"</div>");for(var q=0,r=p.length;q<r&&j<c[k].maxListSize;q+=1)e=$("<li><div class='eac-item'></div></li>"),function(){var a=q,b=j,f=c[k].getValue(p[a]);e.find(" > div").on("click",function(){l.val(f).trigger("change"),o=b,w(b),g.get("list").onClickEvent(),g.get("list").onChooseEvent()}).mouseover(function(){o=b,w(b),g.get("list").onMouseOverEvent()}).mouseout(function(){g.get("list").onMouseOutEvent()}).html(i.build(h(f,d),p[a]))}(),f.append(e),n.push(p[q]),j+=1}}a.append(f),g.get("list").onLoadEvent()})}(),l.after(a)}function e(){l.next("."+f.getValue("CONTAINER_CLASS")).remove()}function h(a,b){return g.get("highlightPhrase")&&""!==b?k(a,b):a}function j(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function k(a,b){var c=j(b);return(a+"").replace(new RegExp("("+c+")","gi"),"<b>$1</b>")}l.parent().hasClass(f.getValue("WRAPPER_CSS_CLASS"))&&(e(),c()),a(),d(),m=$("#"+s()),g.get("placeholder")&&l.attr("placeholder",g.get("placeholder"))}function s(){var a=l.attr("id");return a=f.getValue("CONTAINER_ID")+a}function t(){function a(){k("autocompleteOff",!0)&&m(),b(),c(),d(),e(),f(),i()}function b(){l.focusout(function(){var b,a=l.val();g.get("list").match.caseSensitive||(a=a.toLowerCase());for(var c=0,d=n.length;c<d;c+=1)if(b=g.get("getValue")(n[c]),g.get("list").match.caseSensitive||(b=b.toLowerCase()),b===a)return o=c,void w(o)})}function c(){l.off("keyup").keyup(function(a){function c(a){function e(){var a={},b=g.get("ajaxSettings")||{};for(var c in b)a[c]=b[c];return a}function f(a,b){return g.get("matchResponseProperty")===!1||("string"==typeof g.get("matchResponseProperty")?b[g.get("matchResponseProperty")]===a:"function"!=typeof g.get("matchResponseProperty")||g.get("matchResponseProperty")(b)===a)}if(!(a.length<g.get("minCharNumber"))){if("list-required"!==g.get("data")){var b=g.get("data"),c=j.init(b);c=j.updateCategories(c,b),c=j.processData(c,a),x(c,a),l.parent().find("li").length>0?u():v()}var d=e();void 0!==d.url&&""!==d.url||(d.url=g.get("url")),void 0!==d.dataType&&""!==d.dataType||(d.dataType=g.get("dataType")),void 0!==d.url&&"list-required"!==d.url&&(d.url=d.url(a),d.data=g.get("preparePostData")(d.data,a),$.ajax(d).done(function(b){var c=j.init(b);c=j.updateCategories(c,b),c=j.convertXml(c),f(a,b)&&(c=j.processData(c,a),x(c,a)),j.checkIfDataExists(c)&&l.parent().find("li").length>0?u():v(),g.get("ajaxCallback")()}).fail(function(){h.warning("Fail to load response data")}).always(function(){}))}}switch(a.keyCode){case 27:v(),y();break;case 38:a.preventDefault(),n.length>0&&o>0&&(o-=1,l.val(g.get("getValue")(n[o])),w(o));break;case 40:a.preventDefault(),n.length>0&&o<n.length-1&&(o+=1,l.val(g.get("getValue")(n[o])),w(o));break;default:if(a.keyCode>40||8===a.keyCode){var b=l.val();g.get("list").hideOnEmptyPhrase!==!0||8!==a.keyCode||""!==b?g.get("requestDelay")>0?(void 0!==p&&clearTimeout(p),p=setTimeout(function(){c(b)},g.get("requestDelay"))):c(b):v()}}})}function d(){l.on("keydown",function(a){a=a||window.event;var b=a.keyCode;if(38===b)return suppressKeypress=!0,!1}).keydown(function(a){13===a.keyCode&&o>-1&&(l.val(g.get("getValue")(n[o])),g.get("list").onKeyEnterEvent(),g.get("list").onChooseEvent(),o=-1,v(),a.preventDefault())})}function e(){l.off("keypress")}function f(){l.focus(function(){""!==l.val()&&n.length>0&&(o=-1,u())})}function i(){l.blur(function(){setTimeout(function(){o=-1,v()},250)})}function m(){l.attr("autocomplete","off")}a()}function u(){m.trigger("show.eac")}function v(){m.trigger("hide.eac")}function w(a){m.trigger("selectElement.eac",a)}function x(a,b){m.trigger("loadElements.eac",[a,b])}function y(){l.trigger("blur")}var p,f=new a.Constans,g=new a.Configuration(d),h=new a.Logger,i=new a.Template(d.template),j=new a.ListBuilderService(g,a.proccess),k=g.equals,l=c,m="",n=[],o=-1;a.consts=f,this.getConstants=function(){return f},this.getConfiguration=function(){return g},this.getContainer=function(){return m},this.getSelectedItemIndex=function(){return o},this.getItems=function(){return n},this.getItemData=function(a){return n.length<a||void 0===n[a]?-1:n[a]},this.getSelectedItemData=function(){return this.getItemData(o)},this.build=function(){r()},this.init=function(){q()}},a.eacHandles=[],a.getHandle=function(b){return a.eacHandles[b]},a.inputHasId=function(a){return void 0!==$(a).attr("id")&&$(a).attr("id").length>0},a.assignRandomId=function(b){var c="";do c="eac-"+Math.floor(1e4*Math.random());while(0!==$("#"+c).length);elementId=a.consts.getValue("CONTAINER_ID")+c,$(b).attr("id",c)},a.setHandle=function(b,c){a.eacHandles[c]=b},a}(EasyAutocomplete||{});!function(a){a.fn.easyAutocomplete=function(b){return this.each(function(){var c=a(this),d=new EasyAutocomplete.main(c,b);EasyAutocomplete.inputHasId(c)||EasyAutocomplete.assignRandomId(c),d.init(),EasyAutocomplete.setHandle(d,c.attr("id"))})},a.fn.getSelectedItemIndex=function(){var b=a(this).attr("id");return void 0!==b?EasyAutocomplete.getHandle(b).getSelectedItemIndex():-1},a.fn.getItems=function(){var b=a(this).attr("id");return void 0!==b?EasyAutocomplete.getHandle(b).getItems():-1},a.fn.getItemData=function(b){var c=a(this).attr("id");return void 0!==c&&b>-1?EasyAutocomplete.getHandle(c).getItemData(b):-1},a.fn.getSelectedItemData=function(){var b=a(this).attr("id");return void 0!==b?EasyAutocomplete.getHandle(b).getSelectedItemData():-1}}(jQuery);